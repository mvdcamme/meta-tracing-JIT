(begin (define lst '(0 0 0   0 0 0   0 0 0   0 0 0   0 0 0   0 0 0   0 0 0))
       (define (loop n)
         (define g '()) ;no forward referencing
         (define (f)
           (if (= (car lst) 0)
               (begin (display "f 0") (newline))
               (begin (display "f 1") (newline)))
           (set! lst (cdr lst))
           (g))
         (define (h)
           (if (= (car lst) 0)
               (begin (display "h 0") (newline))
               (begin (display "h 1") (newline)))
           (set! lst (cdr lst))
           'h)
         (define (gg)
           (display "in g") (newline)
           (if (= (car lst) 0)
               (begin (display "g 0") (newline))
               (begin (display "g 1") (newline)))
           (set! lst (cdr lst))
           (h))
         (set! g gg)
         (if (> n 0)
             (begin (f)
                    (loop (- n 1)))))
       
       (loop 7))